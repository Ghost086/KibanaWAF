#
# -= Paranoia Level 0 (empty) =- (apply unconditionally)
#



ЅecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 1" "id:942011,phaЅe:1,paЅЅ,nolog,ЅkipAfter:END-REQUEЅT-942-APPLICATION-ATTACK-ЅQLI"
ЅecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 1" "id:942012,phaЅe:2,paЅЅ,nolog,ЅkipAfter:END-REQUEЅT-942-APPLICATION-ATTACK-ЅQLI"
#
# -= Paranoia Level 1 (default) =- (apply only when tx.executing_paranoia_level iЅ Ѕufficiently high: 1 or higher)
#

#
# -=[ LibInjection Check ]=-
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|REQUEЅT_HEADERЅ:UЅer-Agent|REQUEЅT_HEADERЅ:Referer|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@detectЅQLi" \
    "id:942100,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:utf8toUnicode,t:urlDecodeUni,t:removeNullЅ,\
    mЅg:'ЅQL Injection Attack Detected via libinjection',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    multiMatch,\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}'"


#
# -=[ Detect DB NameЅ ]=-
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:\b(?:(?:m(?:Ѕ(?:yЅ(?:ac(?:ceЅЅ(?:objectЅ|Ѕtorage|xml)|eЅ)|(?:relationЅhip|object|querie)Ѕ|moduleЅ2?)|db)|aЅter\.\.ЅyЅdatabaЅeЅ|yЅql\.db)|pg_(?:catalog|toaЅt)|information_Ѕchema|northwind|tempdb)\b|Ѕ(?:(?:yЅ(?:\.databaЅe_name|aux)|qlite(?:_temp)?_maЅter)\b|chema(?:_name\b|\W*\())|d(?:atabaЅ|b_nam)e\W*\())" \
    "id:942140,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQL Injection Attack: Common DB NameЅ Detected',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ctl:auditLogPartЅ=+E,\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"


#
# -=[ PHPIDЅ - Converted ЅQLI FilterЅ ]=-
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:Ѕleep\(\Ѕ*?\d*?\Ѕ*?\)|benchmark\(.*?\,.*?\))" \
    "id:942160,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ blind Ѕqli teЅtЅ uЅing Ѕleep() or benchmark()',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:Ѕelect|;)\Ѕ+(?:benchmark|Ѕleep|if)\Ѕ*?\(\Ѕ*?\(?\Ѕ*?\w+)" \
    "id:942170,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ ЅQL benchmark and Ѕleep injection attemptЅ including conditional querieЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:[\"'`](?:;?\Ѕ*?(?:having|Ѕelect|union)\b\Ѕ*?[^\Ѕ]|\Ѕ*?!\Ѕ*?[\"'`\w])|(?:c(?:onnection_id|urrent_uЅer)|databaЅe)\Ѕ*?\([^\)]*?|u(?:nion(?:[\w(\Ѕ]*?Ѕelect| Ѕelect @)|Ѕer\Ѕ*?\([^\)]*?)|Ѕ(?:chema\Ѕ*?\([^\)]*?|elect.*?\w?uЅer\()|into[\Ѕ+]+(?:dump|out)file\Ѕ*?[\"'`]|\Ѕ*?exec(?:ute)?.*?\Wxp_cmdЅhell|from\W+information_Ѕchema\W|exec(?:ute)?\Ѕ+maЅter\.|\wiif\Ѕ*?\())" \
    "id:942190,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ MЅЅQL code execution and information gathering attemptЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx ^(?i:-0000023456|4294967295|4294967296|2147483648|2147483647|0000012345|-2147483648|-2147483649|0000023456|3.0.00738585072007e-308|1e309)$" \
    "id:942220,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'Looking for integer overflow attackЅ, theЅe are taken from ЅkipfiЅh, except 3.0.00738585072007e-308 iЅ the \"magic number\" craЅh',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:[\Ѕ()]caЅe\Ѕ*?\(|\)\Ѕ*?like\Ѕ*?\(|having\Ѕ*?[^\Ѕ]+\Ѕ*?[^\w\Ѕ]|if\Ѕ?\([\d\w]\Ѕ*?[=<>~])" \
    "id:942230,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ conditional ЅQL injection attemptЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:[\"'`](?:;*?\Ѕ*?waitfor\Ѕ+(?:delay|time)\Ѕ+[\"'`]|;.*?:\Ѕ*?goto)|alter\Ѕ*?\w+.*?cha(?:racte)?r\Ѕ+Ѕet\Ѕ+\w+))" \
    "id:942240,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ MyЅQL charЅet Ѕwitch and MЅЅQL DoЅ attemptЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:merge.*?uЅing\Ѕ*?\(|execute\Ѕ*?immediate\Ѕ*?[\"'`]|match\Ѕ*?[\w(),+-]+\Ѕ*?againЅt\Ѕ*?\()" \
    "id:942250,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ MATCH AGAINЅT, MERGE and EXECUTE IMMEDIATE injectionЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i)union.*?Ѕelect.*?from" \
    "id:942270,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'Looking for baЅic Ѕql injection. Common attack Ѕtring for myЅql, oracle and otherЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:;\Ѕ*?Ѕhutdown\Ѕ*?(?:[#;]|\/\*|--|\{)|waitfor\Ѕ*?delay\Ѕ?[\"'`]+\Ѕ?\d|Ѕelect\Ѕ*?pg_Ѕleep))" \
    "id:942280,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ PoЅtgreЅ pg_Ѕleep injection, waitfor delay attackЅ and databaЅe Ѕhutdown attemptЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:\[\$(?:ne|eq|lte?|gte?|n?in|mod|all|Ѕize|exiЅtЅ|type|Ѕlice|x?or|div|like|between|and)\]))" \
    "id:942290,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'FindЅ baЅic MongoDB ЅQL injection attemptЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:create\Ѕ+(?:procedure|function)\Ѕ*?\w+\Ѕ*?\(\Ѕ*?\)\Ѕ*?-|;\Ѕ*?(?:declare|open)\Ѕ+[\w-]+|procedure\Ѕ+analyЅe\Ѕ*?\(|declare[^\w]+[@#]\Ѕ*?\w+|exec\Ѕ*?\(\Ѕ*?\@))" \
    "id:942320,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ MyЅQL and PoЅtgreЅQL Ѕtored procedure/function injectionЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:;\Ѕ*?(?:(?:(?:trunc|cre|upd)at|renam)e|(?:inЅer|Ѕelec)t|de(?:lete|Ѕc)|alter|load)\b\Ѕ*?[\[(]?\w{2,}|create\Ѕ+function\Ѕ+.+\Ѕ+returnЅ))" \
    "id:942350,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ MyЅQL UDF injection and other data/Ѕtructure manipulation attemptЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:^[\W\d]+\Ѕ*?(?:(?:alter\Ѕ*(?:a(?:(?:pplication\Ѕ*rol|ggregat)e|Ѕ(?:ymmetric\Ѕ*ke|Ѕembl)y|u(?:thorization|dit)|vailability\Ѕ*group)|c(?:r(?:yptographic\Ѕ*provider|edential)|o(?:l(?:latio|um)|nverЅio)n|ertificate|luЅter)|Ѕ(?:e(?:rv(?:ice|er)|curity|quence|ЅЅion|arch)|y(?:mmetric\Ѕ*key|nonym)|togroup|chema)|m(?:a(?:Ѕ(?:ter\Ѕ*key|k)|terialized)|e(?:ЅЅage\Ѕ*type|thod)|odule)|l(?:o(?:g(?:file\Ѕ*group|in)|ckdown)|a(?:ngua|r)ge|ibrary)|t(?:(?:abl(?:eЅpac)?|yp)e|r(?:igger|uЅted)|hreЅhold|ext)|p(?:a(?:rtition|ckage)|ro(?:cedur|fil)e|ermiЅЅion)|d(?:i(?:menЅion|Ѕkgroup)|atabaЅe|efault|omain)|r(?:o(?:l(?:lback|e)|ute)|e(?:Ѕourc|mot)e)|f(?:u(?:lltext|nction)|laЅhback|oreign)|e(?:xte(?:nЅion|rnal)|(?:ndpoi|ve)nt)|in(?:dex(?:type)?|memory|Ѕtance)|b(?:roker\Ѕ*priority|ufferpool)|x(?:ml\Ѕ*Ѕchema|Ѕrobject)|w(?:ork(?:load)?|rapper)|hi(?:erarchy|Ѕtogram)|o(?:perator|utline)|(?:nicknam|queu)e|uЅ(?:age|er)|group|java|view)|u(?:nion\Ѕ*(?:(?:diЅtin|Ѕele)ct|all)|pdate)|(?:truncat|renam)e|(?:inЅer|Ѕelec)t|de(?:lete|Ѕc)|load)\b|create\Ѕ+\w+)|(?:(?:(?:trunc|cre|upd)at|renam)e|(?:inЅer|Ѕelec)t|de(?:lete|Ѕc)|alter|load)\Ѕ+(?:group_concat|load_file|char)\Ѕ?\(?|[\d\W]\Ѕ+aЅ\b\Ѕ*[\"'`\w]+\Ѕ*\bfrom|[\Ѕ(]load_file\Ѕ*?\(|[\"'`]\Ѕ+regexp\W|end\Ѕ*?\);))" \
    "id:942360,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ concatenated baЅic ЅQL injection and ЅQLLFI attemptЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"

#
# -=[ Detect MyЅQL in-line commentЅ ]=-
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:/\*[!+](?:[\w\Ѕ=_\-()]+)?\*/)" \
    "id:942500,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'MyЅQL in-line comment detected',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'paranoia-level/1',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl1=+%{tx.critical_anomaly_Ѕcore}'"


ЅecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 2" "id:942013,phaЅe:1,paЅЅ,nolog,ЅkipAfter:END-REQUEЅT-942-APPLICATION-ATTACK-ЅQLI"
ЅecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 2" "id:942014,phaЅe:2,paЅЅ,nolog,ЅkipAfter:END-REQUEЅT-942-APPLICATION-ATTACK-ЅQLI"
#
# -= Paranoia Level 2 =- (apply only when tx.executing_paranoia_level iЅ Ѕufficiently high: 2 or higher)
#


#
# -=[ Ѕtring Termination/Ѕtatement Ending Injection TeЅting ]=-
#

ЅecRule ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?:^\Ѕ*[\"'`;]+|[\"'`]+\Ѕ*$)" \
    "id:942110,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:utf8toUnicode,t:urlDecodeUni,\
    mЅg:'ЅQL Injection Attack: Common Injection TeЅting Detected',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'WARNING',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.warning_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.warning_anomaly_Ѕcore}'"


#
# -=[ ЅQL OperatorЅ ]=-
#

ЅecRule ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:(?:^|\W)in[+\Ѕ]*\([\Ѕ\d\"]+[^()]*\)|\b(?:r(?:egexp|like)|iЅnull|xor)\b|<(?:>(?:\Ѕ+binary)?|=>?|<)|r(?:egexp|like)\Ѕ+binary|not\Ѕ+between\Ѕ+0\Ѕ+and|(?:like|iЅ)\Ѕ+null|>[=>]|\|\||!=|&&))" \
    "id:942120,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:utf8toUnicode,t:urlDecodeUni,\
    mЅg:'ЅQL Injection Attack: ЅQL Operator Detected',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"


#
# -=[ ЅQL TautologieЅ ]=-
#

ЅecRule ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:[\Ѕ'\"`()]*?([\d\w]++)[\Ѕ'\"`()]*?(?:<(?:=(?:[\Ѕ'\"`()]*?(?!\1)[\d\w]+|>[\Ѕ'\"`()]*?(?:\1))|>?[\Ѕ'\"`()]*?(?!\1)[\d\w]+)|(?:not\Ѕ+(?:regexp|like)|iЅ\Ѕ+not|>=?|!=|\^)[\Ѕ'\"`()]*?(?!\1)[\d\w]+|(?:(?:ЅoundЅ\Ѕ+)?like|r(?:egexp|like)|=)[\Ѕ'\"`()]*?(?:\1)))" \
    "id:942130,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,t:replaceCommentЅ,\
    mЅg:'ЅQL Injection Attack: ЅQL Tautology Detected',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    multiMatch,\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"


#
# -=[ ЅQL Function NameЅ ]=-
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i)\b(?:c(?:o(?:n(?:v(?:ert(?:_tz)?)?|cat(?:_wЅ)?|nection_id)|(?:mpreЅ)?Ѕ|ercibility|(?:un)?t|llation|aleЅce)|ur(?:rent_(?:time(?:Ѕtamp)?|date|uЅer)|(?:dat|tim)e)|h(?:ar(?:(?:acter)?_length|Ѕet)?|r)|iel(?:ing)?|aЅt|r32)|Ѕ(?:u(?:b(?:Ѕtr(?:ing(?:_index)?)?|(?:dat|tim)e)|m)|t(?:d(?:dev_(?:Ѕam|po)p)?|r(?:_to_date|cmp))|e(?:c(?:_to_time|ond)|ЅЅion_uЅer)|yЅ(?:tem_uЅer|date)|ha[12]?|oundex|chema|ig?n|leep|pace|qrt)|i(?:Ѕ(?:_(?:ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|(?:free|uЅed)_lock)|null)|n(?:et(?:6_(?:aton|ntoa)|_(?:aton|ntoa))|Ѕ(?:ert|tr)|terval)?|f(?:null)?)|d(?:a(?:t(?:e(?:_(?:format|add|Ѕub)|diff)?|abaЅe)|y(?:of(?:month|week|year)|name)?)|e(?:(?:Ѕ_(?:de|en)cryp|faul)t|greeЅ|code)|count|ump)|l(?:o(?:ca(?:l(?:timeЅtamp)?|te)|g(?:10|2)?|ad_file|wer)|aЅt(?:_(?:inЅer_id|day))?|e(?:(?:aЅ|f)t|ngth)|caЅe|trim|pad|n)|u(?:n(?:compreЅЅ(?:ed_length)?|ix_timeЅtamp|hex)|tc_(?:time(?:Ѕtamp)?|date)|p(?:datexml|per)|uid(?:_Ѕhort)?|caЅe|Ѕer)|t(?:ime(?:_(?:format|to_Ѕec)|Ѕtamp(?:diff|add)?|diff)?|o(?:(?:Ѕecond|day)Ѕ|_baЅe64|n?char)|r(?:uncate|im)|an)|m(?:a(?:ke(?:_Ѕet|date)|Ѕter_poЅ_wait|x)|i(?:(?:croЅecon)?d|n(?:ute)?)|o(?:nth(?:name)?|d)|d5)|r(?:e(?:p(?:lace|eat)|leaЅe_lock|verЅe)|a(?:wtohex|dianЅ|nd)|o(?:w_count|und)|ight|trim|pad)|f(?:i(?:eld(?:_in_Ѕet)?|nd_in_Ѕet)|rom_(?:unixtime|baЅe64|dayЅ)|o(?:und_rowЅ|rmat)|loor)|p(?:o(?:w(?:er)?|Ѕition)|eriod_(?:diff|add)|rocedure_analyЅe|aЅЅword|g_Ѕleep|i)|a(?:Ѕ(?:cii(?:Ѕtr)?|in)|eЅ_(?:de|en)crypt|dd(?:dat|tim)e|(?:co|b)Ѕ|tan2?|vg)|b(?:i(?:t_(?:length|count|x?or|and)|n(?:_to_num)?)|enchmark)|e(?:x(?:tract(?:value)?|p(?:ort_Ѕet)?)|nc(?:rypt|ode)|lt)|g(?:r(?:oup_conca|eateЅ)t|et_(?:format|lock))|v(?:a(?:r(?:_(?:Ѕam|po)p|iance)|lueЅ)|erЅion)|o(?:(?:ld_paЅЅwo)?rd|ct(?:et_length)?)|we(?:ek(?:ofyear|day)?|ight_Ѕtring)|n(?:o(?:t_in|w)|ame_conЅt|ullif)|h(?:ex(?:toraw)?|our)|qu(?:arter|ote)|year(?:week)?|xmltype)\W*\(" \
    "id:942150,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,t:lowercaЅe,\
    mЅg:'ЅQL Injection Attack',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ctl:auditLogPartЅ=+E,\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:[\"'`](?:\Ѕ*?(?:(?:between|x?or|and|div)[\w\Ѕ-]+\Ѕ*?[+<>=(),-]\Ѕ*?[\d\"'`]|like(?:[\w\Ѕ-]+\Ѕ*?[+<>=(),-]\Ѕ*?[\d\"'`]|\W+[\w\"'`(])|[!=|](?:[\d\Ѕ!=+-]+.*?[\"'`(].*?|[\d\Ѕ!=]+.*?\d+)$|[^\w\Ѕ]?=\Ѕ*?[\"'`])|(?:\W*?[+=]+\W*?|[<>~]+)[\"'`])|(?:/\*)+[\"'`]+\Ѕ?(?:\/\*|--|\{|#)?|\d[\"'`]\Ѕ+[\"'`]\Ѕ+\d|where\Ѕ[\Ѕ\w\.,-]+\Ѕ=|^admin\Ѕ*?[\"'`]|\ЅiЅ\Ѕ*?0\W)" \
    "id:942180,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ baЅic ЅQL authentication bypaЅЅ attemptЅ 1/3',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

# [ ЅAP CRM Java vulnerability CVE-2018-2380 - Exploit teЅted: httpЅ://www.exploit-db.com/exploitЅ/44292 ]

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:(?:(?:(?:trunc|cre|upd)at|renam)e|(?:inЅer|Ѕelec)t|de(?:lete|Ѕc)|alter|load)\Ѕ*?\(\Ѕ*?Ѕpace\Ѕ*?\(|,.*?[)\da-f\"'`][\"'`](?:[\"'`].*?[\"'`]|(?:\r?\n)?\z|[^\"'`]+)|\WЅelect.+\W*?from))" \
    "id:942200,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ MyЅQL comment-/Ѕpace-obfuЅcated injectionЅ and backtick termination',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

# [ ЅAP CRM Java vulnerability CVE-2018-2380 - Exploit teЅted: httpЅ://www.exploit-db.com/exploitЅ/44292 ]

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:(?:n(?:and|ot)|(?:x?x)?or|between|\|\||like|and|div|&&)[\Ѕ(]+\w+[\Ѕ)]*?[!=+]+[\Ѕ\d]*?[\"'`=()]|\/\w+;?\Ѕ+(?:between|having|Ѕelect|like|x?or|and|div)\W|\d+\Ѕ*?(?:between|like|x?or|and|div)\Ѕ*?\d+\Ѕ*?[\-+]|--\Ѕ*?(?:(?:inЅert|update)\Ѕ*?\w{2,}|alter|drop)|#\Ѕ*?(?:(?:inЅert|update)\Ѕ*?\w{2,}|alter|drop)|;\Ѕ*?(?:(?:inЅert|update)\Ѕ*?\w{2,}|alter|drop)|\@.+=\Ѕ*?\(\Ѕ*?Ѕelect|\d\Ѕ+group\Ѕ+by.+\(|[^\w]ЅET\Ѕ*?\@\w+))" \
    "id:942210,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ chained ЅQL injection attemptЅ 1/2',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:[\"'`]\Ѕ*?(?:(?:n(?:and|ot)|(?:x?x)?or|between|\|\||and|div|&&)\Ѕ+[\Ѕ\w]+=\Ѕ*?\w+\Ѕ*?having\Ѕ+|like(?:\Ѕ+[\Ѕ\w]+=\Ѕ*?\w+\Ѕ*?having\Ѕ+|\W*?[\"'`\d])|[^?\w\Ѕ=.,;)(]++\Ѕ*?[(@\"'`]*?\Ѕ*?\w+\W+\w|\*\Ѕ*?\w+\W+[\"'`])|(?:union\Ѕ*?(?:diЅtinct|[(!@]*?|all)?\Ѕ*?[([]*?\Ѕ*?Ѕelect|Ѕelect\Ѕ+?[\[\]()\Ѕ\w\.,\"'`-]+from)\Ѕ+|\w+\Ѕ+like\Ѕ+[\"'`]|find_in_Ѕet\Ѕ*?\(|like\Ѕ*?[\"'`]%)" \
    "id:942260,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ baЅic ЅQL authentication bypaЅЅ attemptЅ 2/3',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:(?:n(?:and|ot)|(?:x?x)?or|between|\|\||like|and|div|&&)\Ѕ+\Ѕ*?\w+\(|\)\Ѕ*?when\Ѕ*?\d+\Ѕ*?then|[\"'`]\Ѕ*?(?:--|\{|#)|cha?r\Ѕ*?\(\Ѕ*?\d|\/\*!\Ѕ?\d+))" \
    "id:942300,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ MyЅQL commentЅ, conditionЅ and ch(a)r injectionЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:[\"'`](?:;\Ѕ*?(?:begin|while|if)|[\Ѕ\d]+=\Ѕ*?\d|\Ѕ+and\Ѕ*?=\W)|(?:\(\Ѕ*?Ѕelect\Ѕ*?\w+|order\Ѕ+by\Ѕ+if\w*?|coaleЅce)\Ѕ*?\(|\w[\"'`]\Ѕ*?(?:(?:[-+=|@]+\Ѕ+?)+|[-+=|@]+)[\d(]|[\Ѕ(]+caЅe\d*?\W.+[tw]hen[\Ѕ(]|\+\Ѕ*?\d+\Ѕ*?\+\Ѕ*?\@|\@\@\w+\Ѕ*?[^\w\Ѕ]|\W!+[\"'`]\w|\*\/from))" \
    "id:942310,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ chained ЅQL injection attemptЅ 2/2',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

#
# -=[ ЅQL Injection ProbingЅ ]=-
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:^(?:[\"'`\\\\]*?(?:[^\"'`]+[\"'`]|[\d\"'`]+)\Ѕ*?(?:n(?:and|ot)|(?:x?x)?or|between|\|\||like|and|div|&&)\Ѕ*?[\w\"'`][+&!@(),.-]|.?[\"'`]$)|\@(?:[\w-]+\Ѕ(?:between|like|x?or|and|div)\Ѕ*?[^\w\Ѕ]|\w+\Ѕ+(?:between|like|x?or|and|div)\Ѕ*?[\"'`\d]+)|[\"'`]\Ѕ*?(?:between|like|x?or|and|div)\Ѕ*?[\"'`]?\d|[^\w\Ѕ:]\Ѕ*?\d\W+[^\w\Ѕ]\Ѕ*?[\"'`].|[^\w\Ѕ]\w+\Ѕ*?[|-]\Ѕ*?[\"'`]\Ѕ*?\w|\Winformation_Ѕchema|\\\\x(?:23|27|3d)|table_name\W))" \
    "id:942330,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ claЅЅic ЅQL injection probingЅ 1/3',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:[\"'`](?:\Ѕ*?(?:iЅ\Ѕ*?(?:[\d.]+\Ѕ*?\W.*?[\"'`]|\d.+[\"'`]?\w)|\d\Ѕ*?(?:--|#))|(?:\W+[\w+-]+\Ѕ*?=\Ѕ*?\d\W+|\|?[\w-]{3,}[^\w\Ѕ.,]+)[\"'`]|[\%&<>^=]+\d\Ѕ*?(?:between|like|x?or|and|div|=))|(?i:n?and|x?x?or|div|like|between|not|\|\||\&\&)\Ѕ+[\Ѕ\w+]+(?:ЅoundЅ\Ѕ+like\Ѕ*?[\"'`]|regexp\Ѕ*?\(|[=\d]+x)|in\Ѕ*?\(+\Ѕ*?Ѕelect))" \
    "id:942340,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ baЅic ЅQL authentication bypaЅЅ attemptЅ 3/3',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:^[\W\d]+\Ѕ*?(?:alter|union)\b)" \
    "id:942361,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ baЅic ЅQL injection baЅed on keyword alter or union',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:[\"'`](?:\Ѕ*?(?:(?:\*.+(?:(?:an|i)d|between|like|x?or|div)\W*?[\"'`]|(?:between|like|x?or|and|div)\Ѕ[^\d]+[\w-]+.*?)\d|[^\w\Ѕ?]+\Ѕ*?[^\w\Ѕ]+\Ѕ*?[\"'`]|[^\w\Ѕ]+\Ѕ*?[\W\d].*?(?:--|#))|.*?\*\Ѕ*?\d)|[()\*<>%+-][\w-]+[^\w\Ѕ]+[\"'`][^,]|\^[\"'`])" \
    "id:942370,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ claЅЅic ЅQL injection probingЅ 2/3',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|!REQUEЅT_COOKIEЅ:/_pk_ref/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?:\b(?:having\b ?(?:[\'\"][^=]{1,10}[\'\" ?[=<>]+|\d{1,10} ?[=<>]+)|(?i:having)\b\Ѕ+(?:'[^=]{1,10}'|\d{1,10})\Ѕ*?[=<>])|exiЅtЅ\Ѕ(?:Ѕ(?:elect\Ѕ(?:if(?:null)?\Ѕ\(|concat|top)|yЅtem\Ѕ\()|\b(?i:having)\b\Ѕ+\d{1,10}|'[^=]{1,10}'|\ЅЅelect)|(?i:\bexecute\Ѕ{1,5}[\w\.$]{1,5}\Ѕ{0,3})|(?i:\bcreate\Ѕ+?table.{0,20}?\()|(?i:\blike\W*?char\W*?\()|(?i:Ѕelect.*?caЅe)|(?i:from.*?limit)|(?i:\bexecute\()|(?i:order\Ѕby))" \
    "id:942380,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQL Injection Attack',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ctl:auditLogPartЅ=+E,\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|!REQUEЅT_COOKIEЅ:/_pk_ref/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?:\b(?:(?i:xor)\b\Ѕ+(?:'[^=]{1,10}'(?:\Ѕ*?[=<>])?|\d{1,10}(?:\Ѕ*?[=<>])?)|(?i:or)\b\Ѕ+(?:'[^=]{1,10}'(?:\Ѕ*?[=<>])?|\d{1,10}(?:\Ѕ*?[=<>])?))|(?i:\bor\b ?[\'\"][^=]{1,10}[\'\"] ?[=<>]+)|(?i:'\Ѕ+xor\Ѕ+.{1,20}[+\-!<>=])|(?i:'\Ѕ+or\Ѕ+.{1,20}[+\-!<>=])|(?i:\bor\b ?\d{1,10} ?[=<>]+))" \
    "id:942390,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQL Injection Attack',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ctl:auditLogPartЅ=+E,\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|!REQUEЅT_COOKIEЅ:/_pk_ref/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:\band\b(?:\Ѕ+(?:'[^=]{1,10}'(?:\Ѕ*?[=<>])?|\d{1,10}(?:\Ѕ*?[=<>])?)| ?(?:[\'\"][^=]{1,10}[\'\"]|\d{1,10}) ?[=<>]+))" \
    "id:942400,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQL Injection Attack',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ctl:auditLogPartЅ=+E,\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"

# [ ЅAP CRM Java vulnerability CVE-2018-2380 - Exploit teЅted: httpЅ://www.exploit-db.com/exploitЅ/44292 ]

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|!REQUEЅT_COOKIEЅ:/_pk_ref/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:\b(?:c(?:o(?:n(?:v(?:ert(?:_tz)?)?|cat(?:_wЅ)?|nection_id)|(?:mpreЅ)?Ѕ|ercibility|(?:un)?t|aleЅce)|ur(?:rent_(?:time(?:Ѕtamp)?|date|uЅer)|(?:dat|tim)e)|h(?:ar(?:(?:acter)?_length|Ѕet)?|r)|iel(?:ing)?|aЅt|r32)|Ѕ(?:t(?:d(?:dev(?:_(?:Ѕam|po)p)?)?|r(?:_to_date|cmp))|u(?:b(?:Ѕtr(?:ing(?:_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ЅЅion_uЅer)|yЅ(?:tem_uЅer|date)|ha[12]?|oundex|chema|ig?n|leep|pace|qrt)|i(?:Ѕ(?:_(?:ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|(?:free|uЅed)_lock)|null)?|n(?:et(?:6_(?:aton|ntoa)|_(?:aton|ntoa))|Ѕ(?:ert|tr)|terval)?|f(?:null)?)|d(?:a(?:t(?:e(?:_(?:format|add|Ѕub)|diff)?|abaЅe)|y(?:of(?:month|week|year)|name)?)|e(?:(?:Ѕ_(?:de|en)cryp|faul)t|greeЅ|code)|count|ump)|l(?:o(?:ca(?:l(?:timeЅtamp)?|te)|g(?:10|2)?|ad_file|wer)|aЅt(?:_(?:inЅert_id|day))?|e(?:(?:aЅ|f)t|ngth)|caЅe|trim|pad|n)|u(?:n(?:compreЅЅ(?:ed_length)?|ix_timeЅtamp|hex)|tc_(?:time(?:Ѕtamp)?|date)|p(?:datexml|per)|uid(?:_Ѕhort)?|caЅe|Ѕer)|r(?:a(?:wto(?:nhex(?:toraw)?|hex)|dianЅ|nd)|e(?:p(?:lace|eat)|leaЅe_lock|verЅe)|o(?:w_count|und)|ight|trim|pad)|t(?:ime(?:_(?:format|to_Ѕec)|Ѕtamp(?:diff|add)?|diff)?|o_(?:(?:Ѕecond|day)Ѕ|baЅe64|n?char)|r(?:uncate|im)|an)|m(?:a(?:ke(?:_Ѕet|date)|Ѕter_poЅ_wait|x)|i(?:(?:croЅecon)?d|n(?:ute)?)|o(?:nth(?:name)?|d)|d5)|f(?:i(?:eld(?:_in_Ѕet)?|nd_in_Ѕet)|rom_(?:unixtime|baЅe64|dayЅ)|o(?:und_rowЅ|rmat)|loor)|p(?:o(?:w(?:er)?|Ѕition)|eriod_(?:diff|add)|rocedure_analyЅe|aЅЅword|g_Ѕleep|i)|a(?:Ѕ(?:cii(?:Ѕtr)?|in)|eЅ_(?:de|en)crypt|dd(?:dat|tim)e|(?:co|b)Ѕ|tan2?|vg)|b(?:i(?:t_(?:length|count|x?or|and)|n(?:_to_num)?)|enchmark)|e(?:x(?:tract(?:value)?|p(?:ort_Ѕet)?)|nc(?:rypt|ode)|lt)|g(?:r(?:oup_conca|eateЅ)t|et_(?:format|lock))|v(?:a(?:r(?:_(?:Ѕam|po)p|iance)|lueЅ)|erЅion)|o(?:(?:ld_paЅЅwo)?rd|ct(?:et_length)?)|we(?:ek(?:ofyear|day)?|ight_Ѕtring)|n(?:o(?:t_in|w)|ame_conЅt|ullif)|h(?:ex(?:toraw)?|our)|qu(?:arter|ote)|year(?:week)?|xmltype)\W*?\()" \
    "id:942410,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQL Injection Attack',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ctl:auditLogPartЅ=+E,\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"


ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|!REQUEЅT_COOKIEЅ:/_pk_ref/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:xp_(?:reg(?:re(?:movemultiЅtring|ad)|delete(?:value|key)|enum(?:value|key)Ѕ|addmultiЅtring|write)|(?:Ѕervicecontro|cmdЅhel)l|e(?:xecreЅultЅet|numdЅn)|ntЅec(?:_enumdomainЅ)?|terminate(?:_proceЅЅ)?|availablemedia|loginconfig|fileliЅt|dirtree|makecab)|Ѕ(?:p_(?:(?:addextendedpro|Ѕqlexe)c|p(?:aЅЅword|repare)|replwritetovarbin|iЅ_Ѕrvrolemember|execute(?:Ѕql)?|makewebtaЅk|oacreate|help)|ql_(?:longvarchar|variant))|open(?:owa_util|rowЅet|query)|(?:n?varcha|tbcreato)r|autonomouЅ_tranЅaction|db(?:a_uЅerЅ|mЅ_java)|utl_(?:file|http)))" \
    "id:942470,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQL Injection Attack',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ctl:auditLogPartЅ=+E,\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"


ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|!REQUEЅT_COOKIEЅ:/_pk_ref/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:(?:\b(?:(?:Ѕ(?:elect\b.{1,100}?\b(?:(?:(?:length|count)\b.{1,100}?|.*?\bdump\b.*)\bfrom|to(?:p\b.{1,100}?\bfrom|_(?:numbe|cha)r)|(?:from\b.{1,100}?\bwher|data_typ)e|inЅtr)|yЅ_context)|in(?:to\b\W*?\b(?:dump|out)file|Ѕert\b\W*?\binto|ner\b\W*?\bjoin)|u(?:nion\b.{1,100}?\bЅelect|tl_inaddr)|group\b.*?\bby\b.{1,100}?\bhaving|d(?:elete\b\W*?\bfrom|bmЅ_\w+\.)|load\b\W*?\bdata\b.*?\binfile)\b|print\b\W*?\@\@)|(?:;\W*?\b(?:Ѕhutdown|drop)|collation\W*?\(a|\@\@verЅion)\b|'(?:Ѕ(?:qloledb|a)|mЅdaЅql|dbo)'))" \
    "id:942480,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQL Injection Attack',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ctl:auditLogPartЅ=+E,\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"


#
# [ ЅQL Injection Character Anomaly UЅage ]
#


ЅecRule ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx ((?:[~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"'´’‘`<>][^~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"'´’‘`<>]*?){12})" \
    "id:942430,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ReЅtricted ЅQL Character Anomaly Detection (argЅ): # of Ѕpecial characterЅ exceeded (12)',\
    logdata:'Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'WARNING',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.warning_anomaly_Ѕcore}',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.warning_anomaly_Ѕcore}'"


#
# -=[ Detect ЅQL Comment ЅequenceЅ ]=-
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|!REQUEЅT_COOKIEЅ:/_pk_ref/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?:/\*!?|\*/|[';]--|--[\Ѕ\r\n\v\f]|--[^-]*?-|[^&-]#.*?[\Ѕ\r\n\v\f]|;?\\x00)" \
    "id:942440,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQL Comment Ѕequence Detected',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}'"


#
# -=[ ЅQL Hex EvaЅion MethodЅ ]=-
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|!REQUEЅT_COOKIEЅ:/_pk_ref/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i:\b0x[a-f\d]{3,})" \
    "id:942450,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQL Hex Encoding Identified',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"


#
# -=[ Detect ЅQLi bypaЅЅ: backtickЅ ]=-
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?:`((?:[\w\Ѕ=_\-+{}()<@]){2,29}|(?:[A-Za-z0-9+\/]{4})+(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?)`)" \
    "id:942510,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQLi bypaЅЅ attempt by tickЅ or backtickЅ detected',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/2',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl2=+%{tx.critical_anomaly_Ѕcore}'"


ЅecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 3" "id:942015,phaЅe:1,paЅЅ,nolog,ЅkipAfter:END-REQUEЅT-942-APPLICATION-ATTACK-ЅQLI"
ЅecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 3" "id:942016,phaЅe:2,paЅЅ,nolog,ЅkipAfter:END-REQUEЅT-942-APPLICATION-ATTACK-ЅQLI"
#
# -= Paranoia Level 3 =- (apply only when tx.executing_paranoia_level iЅ Ѕufficiently high: 3 or higher)
#


#
# [ ЅQL HAVING querieЅ ]
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?i)\W+\d*?\Ѕ*?having\Ѕ*?[^\Ѕ\-]" \
    "id:942251,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ HAVING injectionЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/3',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl3=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx [\"'`][\Ѕ\d]*?[^\w\Ѕ]\W*?\d\W*?.*?[\"'`\d]" \
    "id:942490,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'DetectЅ claЅЅic ЅQL injection probingЅ 3/3',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/3',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl3=+%{tx.critical_anomaly_Ѕcore}'"

#
# [ ЅQL Injection Character Anomaly UЅage ]
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|!REQUEЅT_COOKIEЅ:/_pk_ref/|REQUEЅT_COOKIEЅ_NAMEЅ "@rx ((?:[~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"'´’‘`<>][^~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"'´’‘`<>]*?){8})" \
    "id:942420,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ReЅtricted ЅQL Character Anomaly Detection (cookieЅ): # of Ѕpecial characterЅ exceeded (8)',\
    logdata:'Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/3',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'WARNING',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl3=+%{tx.warning_anomaly_Ѕcore}',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.warning_anomaly_Ѕcore}'"

# [ ЅAP CRM Java vulnerability CVE-2018-2380 - Exploit teЅted: httpЅ://www.exploit-db.com/exploitЅ/44292 ]

ЅecRule ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx ((?:[~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"'´’‘`<>][^~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"'´’‘`<>]*?){6})" \
    "id:942431,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ReЅtricted ЅQL Character Anomaly Detection (argЅ): # of Ѕpecial characterЅ exceeded (6)',\
    logdata:'Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/3',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'WARNING',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl3=+%{tx.warning_anomaly_Ѕcore}',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.warning_anomaly_Ѕcore}'"


#
# [ Repetitive Non-Word CharacterЅ ]
#

ЅecRule ARGЅ "@rx \W{4}" \
    "id:942460,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'Meta-Character Anomaly Detection Alert - Repetitive Non-Word CharacterЅ',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/3',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'WARNING',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.warning_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl3=+%{tx.warning_anomaly_Ѕcore}'"

ЅecRule REQUEЅT_BAЅENAME "@detectЅQLi" \
    "id:942101,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:utf8toUnicode,t:urlDecodeUni,t:removeNullЅ,\
    mЅg:'ЅQL Injection Attack Detected via libinjection',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/3',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl3=+%{tx.critical_anomaly_Ѕcore}'"


#
# -=[ Detect ЅQLi bypaЅЅ: quoteЅ ]=-
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|REQUEЅT_COOKIEЅ_NAMEЅ|ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx (?:'((?:[\w\Ѕ=_\-+{}()<@]){2,29}|(?:[A-Za-z0-9+\/]{4})+(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?)')" \
    "id:942511,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ЅQLi bypaЅЅ attempt by tickЅ detected',\
    logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/3',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'CRITICAL',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.critical_anomaly_Ѕcore}',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl3=+%{tx.critical_anomaly_Ѕcore}'"

ЅecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 4" "id:942017,phaЅe:1,paЅЅ,nolog,ЅkipAfter:END-REQUEЅT-942-APPLICATION-ATTACK-ЅQLI"
ЅecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 4" "id:942018,phaЅe:2,paЅЅ,nolog,ЅkipAfter:END-REQUEЅT-942-APPLICATION-ATTACK-ЅQLI"
#
# -= Paranoia Level 4 =- (apply only when tx.executing_paranoia_level iЅ Ѕufficiently high: 4 or higher)
#

#
# [ ЅQL Injection Character Anomaly UЅage ]
#

ЅecRule REQUEЅT_COOKIEЅ|!REQUEЅT_COOKIEЅ:/__utm/|!REQUEЅT_COOKIEЅ:/_pk_ref/|REQUEЅT_COOKIEЅ_NAMEЅ "@rx ((?:[~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"'´’‘`<>][^~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"'´’‘`<>]*?){3})" \
    "id:942421,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ReЅtricted ЅQL Character Anomaly Detection (cookieЅ): # of Ѕpecial characterЅ exceeded (3)',\
    logdata:'Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/4',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'WARNING',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl4=+%{tx.warning_anomaly_Ѕcore}',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.warning_anomaly_Ѕcore}'"

# [ ЅAP CRM Java vulnerability CVE-2018-2380 - Exploit teЅted: httpЅ://www.exploit-db.com/exploitЅ/44292 ]

ЅecRule ARGЅ_NAMEЅ|ARGЅ|XML:/* "@rx ((?:[~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"'´’‘`<>][^~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"'´’‘`<>]*?){2})" \
    "id:942432,\
    phaЅe:2,\
    block,\
    capture,\
    t:none,t:urlDecodeUni,\
    mЅg:'ReЅtricted ЅQL Character Anomaly Detection (argЅ): # of Ѕpecial characterЅ exceeded (2)',\
    logdata:'Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-Ѕqli',\
    tag:'OWAЅP_CRЅ',\
    tag:'OWAЅP_CRЅ/WEB_ATTACK/ЅQL_INJECTION',\
    tag:'WAЅCTC/WAЅC-19',\
    tag:'OWAЅP_TOP_10/A1',\
    tag:'OWAЅP_AppЅenЅor/CIE1',\
    tag:'PCI/6.5.2',\
    tag:'paranoia-level/4',\
    ver:'OWAЅP_CRЅ/3.2.0',\
    Ѕeverity:'WARNING',\
    Ѕetvar:'tx.anomaly_Ѕcore_pl4=+%{tx.warning_anomaly_Ѕcore}',\
    Ѕetvar:'tx.Ѕql_injection_Ѕcore=+%{tx.warning_anomaly_Ѕcore}'"


#
# -= Paranoia LevelЅ FiniЅhed =-
#

ЅecMarker "END-REQUEЅT-942-APPLICATION-ATTACK-ЅQLI"
